{
    "contents" : "\\documentclass{article}\n\n\\begin{document}\n\\SweaveOpts{concordance=TRUE}\n\n\\title{Body Weights of High Fat Diet Cohort 6}\n\\author{Matt Peloquin and Dave Bridges}\n\\date{enter this}\n\n\\maketitle\n\n\\section*{Data}\nMice were ordered from Jackson labs and arrived on 2013-09-18 at 8-9 weeks of age.  They were separated in to 5 cages of 4 for High Fat Diet and 3 cages of 5 for Normal Chow Diet.  After 11 days of acclimatization, on 2012-10-16 they were ear tagged weighed and put on Control Diet (Research Diets D12451) or High Fat Diets (Research Diets D12451).  Body weight and food usage was monitored every other week.\n\n\\section*{Body Weight Data}\n<<data-entry>>=\nstart <- \"http://bridgeslab.uthsc.edu/mousedb/experiment/84/csv\"\nweek2 <- \"http://bridgeslab.uthsc.edu/mousedb/experiment/87/csv\"\nweek4 <- \"http://bridgeslab.uthsc.edu/mousedb/experiment/88/csv\"\nweek6 <- \"http://bridgeslab.uthsc.edu/mousedb/experiment/89/csv\"\nweek8 <- \"http://bridgeslab.uthsc.edu/mousedb/experiment/90/csv\"\nweek10 <- \"http://bridgeslab.uthsc.edu/mousedb/experiment/94/csv\"\nweek12 <- \"http://bridgeslab.uthsc.edu/mousedb/experiment/95/csv\"\n\nstart.data <- read.csv(start)\nweek2.data <- read.csv(week2)\nweek4.data <- read.csv(week4)\nweek6.data <- read.csv(week6)\nweek8.data <- read.csv(week8)\nweek10.data <- read.csv(week10)\nweek12.data <- read.csv(week12)\n\nall.data <- rbind(start.data,\n                  week2.data, \n                  week4.data,\n                  week6.data,\n                  week8.data,\n                  week10.data,\n                  week12.data)\n\nall.data$Cage <- as.factor(all.data$Cage)\nall.data$Weight <- all.data$Values/1000\nall.data <- droplevels(all.data[all.data$Strain == 'C57BL/6J',])\n\n#rename treatment groups\nlevels(all.data$Treatment) <- c(\"Control Diet\",\"High Fat Diet\")\nall.data$Treatment <- relevel(all.data$Treatment, ref=\"Control Diet\")\n \nall.data$Week <- as.integer((all.data$Age - 69)/7)\nwrite.csv(all.data, \"Weekly Body Weight Data.csv\")\n@\n\n\\subsection*{Body Weight Statistics}\n<<statistics>>=\nstart.fit.cage <- aov(Weight ~ Cage, subset(all.data, Week ==0))\ncage.start.t.tests <- with(subset(all.data, Week ==0), \n     pairwise.t.test(Weight,Cage,p.adjust.method=\"BH\"))\nsimple.t.tests <- c(\n  with(subset(all.data, Week ==0), t.test(Weight~Treatment))$p.value,\n  with(subset(all.data, Week ==2), t.test(Weight~Treatment))$p.value,\n  with(subset(all.data, Week ==4), t.test(Weight~Treatment))$p.value,\n  with(subset(all.data, Week ==6), t.test(Weight~Treatment))$p.value,\n  with(subset(all.data, Week ==8), t.test(Weight~Treatment))$p.value,\n  with(subset(all.data, Week ==10), t.test(Weight~Treatment))$p.value,\n  with(subset(all.data, Week >=11), t.test(Weight~Treatment))$p.value )\nnames(simple.t.tests) <- c(\"Starting\", \"Week 2\", \"Week 4\",\"Week 6\",\"Week 8\", \"Week 10\", \"Week 12\")\nt.tests <- data.frame(Uncorrected = simple.t.tests, \n                      Corrected = p.adjust(simple.t.tests, \n                                           n=length(simple.t.tests), \n                                           method=\"BH\"))\n\n\nrequire(lme4)\nnlme.fit <- lmer(Weight~Treatment + Week + (1|Animal), data=all.data)\nsummary(nlme.fit)\n#this is for the post-hoc hypothesis testing\nrequire(multcomp)\nghlt.nlme.fit <- glht(nlme.fit, linfct=mcp(Treatment=\"Tukey\"))\nsummary(ghlt.nlme.fit)\n@\n\nThe average cage effect was \\Sexpr{round(mean(abs(start.fit.cage$effects[2:8])),3)} grams.  In Figure \\ref{fig:one} is the initial cage effects.  The p-value for significance of Cage differences generally is \\Sexpr{round(summary(start.fit.cage)[[1]][[\"Pr(>F)\"]][1],5)} (see ANOVA in Table \\ref{tab:one} with the specific paired t-tests shown in Table \\ref{tab:two}\n\n<<label=data-tables,echo=FALSE,results=tex>>=\nrequire(xtable)\nprint(xtable(summary(start.fit.cage), caption = \"ANOVA for Cage Effects on Weights\", label = \"tab:one\"), include.rownames=T)\nprint(xtable(cage.start.t.tests$p.value, caption = \"Starting Conditions, Paired T-tests for\n             Cage Effects on Weights\", label = \"tab:two\"), include.rownames=T)\nprint(xtable(t.tests, caption = \"Weekly Unadjusted and BH Adjusted T-tests\", label = \"tab:three\", digits=8), include.rownames=T)\n@\n\n<<label=start-cage-effects, include=FALSE, echo=FALSE>>=\ncage.effects <- sort(start.fit.cage$effects[2:8])\npar(mai=c(1,2,1,1))\nbarplot(cage.effects, horiz=T, las=1, \n        col=c(grey.colors(2)[2],\n          grey.colors(2)[1],\n          grey.colors(2)[2],\n          grey.colors(2)[1],\n          grey.colors(2)[2],\n          grey.colors(2)[1],\n          grey.colors(2)[1]\n        ))\nlegend(\"topleft\", c(\"High Fat Diet\",\"Normal Chow Diet\"), fill=grey.colors(2), bty=\"n\")\n@\n\n\\begin{figure}\n\\begin{center}\n<<label=start-cage-effects,fig=TRUE,echo=FALSE>>=\n<<start-cage-effects>>\n@\n\\end{center}\n\\caption{Summary of Initial Cage Effects on Weights.}\n\\label{fig:one}\n\\end{figure}\n\n\\subsection*{Body Weight Graphs}\n\n<<label=weights, include=FALSE, echo=FALSE>>=\nrequire(ggplot2)\nrequire(plyr)\np <- ggplot(all.data, aes(as.vector(Week), Weight))\nmeans <- ddply(all.data, Week~Treatment, summarise, Weight = mean(Weight))#this is a workaround due to a bug in plyr 1.8\nplot <- p + geom_point(aes(col=Treatment)) + labs(list(x = \"Weeks on Diet\", y = \"Body Weight(g)\")) + theme(legend.position = \"top\") + geom_line(data=means, aes(group=Treatment, col=Treatment)) #this is a workaround due to a bug in plyr 1.8\n@\n\n\\begin{figure}\n\\begin{center}\n<<label=weights,fig=TRUE,echo=FALSE>>=\nplot\n@\n\\end{center}\n\\caption{Body Weights}\n\\label{fig:two}\n\\end{figure}\n\n\\section*{Food Intake}\n<<food-data-entry, echo=FALSE>>=\nfood.intake.location <- 'https://docs.google.com/spreadsheet/pub?key=0AvCX4dUmFi0LdGwxUFRwcWZzdlIzVTN3QWVROGVzQ3c&single=true&gid=0&output=csv'\nrequire(RCurl, quietly=T)\nfood.intake.file <- getURL(food.intake.location)\nfood.data <- read.csv(textConnection(food.intake.file))\n\nrequire(reshape)\nfood.data.melted <- melt(food.data, id.vars=c(\"Diet\", \"Cage\"))\n#normalized to per mouse per day\nfood.data.melted$Normalized <- food.data.melted$value/14\nfood.data.melted$Week <- c(rep(2,10), rep(4,10), rep(6,10), rep(8,10), rep(10,10), rep(12,10))\ncd.caloric <- 3.85\nhfd.caloric <- 3.85\ncaloric.order <- c(rep(hfd.caloric,6), rep(cd.caloric,4))\nfood.data.melted$Caloric <- food.data.melted$Normalized*rep(caloric.order,5)\nwrite.csv(food.data.melted, \"Calculated Food Intake.csv\")\n@\n\n<<food-intake-statistics, echo=FALSE>>=\nabs.t.test <- with(food.data.melted, t.test(Normalized~Diet))\ncaloric.t.test <- with(food.data.melted, t.test(Caloric~Diet))\n\ncaloric.nlme.fit <- lmer(Caloric~Diet + variable + (1|Cage), data=food.data.melted)\ncaloric.nlme.glht <- glht(caloric.nlme.fit, linfct=mcp(Diet=\"Tukey\"))\nsummary(caloric.nlme.glht)\n\nabs.nlme.fit <- lmer(Normalized~Diet + variable + (1|Cage), data=food.data.melted)\nabs.nlme.glht <- glht(abs.nlme.fit, linfct=mcp(Diet=\"Tukey\"))\nsummary(abs.nlme.glht)\n@\n\n\\subsection*{Analysis of Food Intake}\n\n<<label=data-tables,echo=FALSE,results=tex>>=\nprint(xtable(food.data.melted, caption = \"Food Intake Values\", label = \"tab:four\"), include.rownames=F)\n@\n\nThe caloric content of the food for Normal Chow Diet is \\Sexpr{cd.caloric} kcal/gm and for High Fat Diet is \\Sexpr{hfd.caloric}\n\n\\subsection*{Food Intake Statistics}\n\n\n\\subsection*{Food Intake Graphs}\n\n<<label=food-caloric-weekly, include=FALSE, echo=FALSE>>=\nrequire(ggplot2)\ncaloric <- ggplot(food.data.melted, aes(Week, Caloric))\ncaloric.means <- ddply(food.data.melted, Week~Diet, summarise, Caloric = mean(Caloric))#this is a workaround due to a bug in plyr 1.8\ncaloric.plot <- caloric + geom_point(aes(color=Diet))  + geom_line(data=caloric.means, aes(group=Diet, col=Diet)) + ylab(\"Food Intake (kcal/mouse/day)\") + ylim(0,max(food.data.melted$Caloric))\n@\n\n\\begin{figure}\n\\begin{center}\n<<label=food-coloric-weekly,fig=TRUE,echo=FALSE>>=\ncaloric.plot\n@\n\\end{center}\n\\caption{Weekly Food Intake By Calories}\n\\label{fig:three}\n\\end{figure}\n\n<<label=food-abs-weekly, include=FALSE, echo=FALSE>>=\nn <- ggplot(food.data.melted, aes(Week, Normalized))\nnormalized.means <- ddply(food.data.melted, Week~Diet, summarise, Normalized = mean(Normalized))#this is a workaround due to a bug in plyr 1.8\nabs.plot <- n + geom_point(aes(color=Diet)) + ylim(0,6) + geom_line(data=normalized.means, aes(group=Diet, col=Diet)) + ylab(\"Food Intake (g/mouse/day)\") #this is a workaround due to a bug in plyr 1.8\n@\n\n\\begin{figure}\n\\begin{center}\n<<label=food-abs-weekly,fig=TRUE,echo=FALSE>>=\nabs.plot\n@\n\\end{center}\n\\caption{Absolute Food Intake By Calories}\n\\label{fig:four}\n\\end{figure}\n\n\n\\section*{Session Information}\n<<sessionInfo, results=tex, echo=F>>=\ntoLatex(sessionInfo())\n@\n\n\\end{document}",
    "created" : 1380559288470.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "927677935",
    "id" : "8B2E79E",
    "lastKnownWriteTime" : 1380559363,
    "path" : "/Volumes/bridges_lab-1/Peloquin/Mouse Work/High Fat Diet Mice/HFD #6/analysis.Rnw",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "sweave"
}