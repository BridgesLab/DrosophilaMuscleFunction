{
    "contents" : "\\documentclass{article}\n\n\\usepackage{fullpage}\n\\usepackage[colorlinks=true]{hyperref}\n\\usepackage[tableposition=top]{caption}\n\\usepackage[utf8]{inputenc}\n\n\\begin{document}\n\\SweaveOpts{concordance=FALSE}\n\n\\title{Analysis of Birth Ratios for Muscle TSC1/Raptor Flies -- Second Crosses}\n\\author{Isabelle Hatfield and Dave Bridges}\n\\date{\\today}\n\\maketitle\n\n\n\\section*{Experimental Design}\n\nThis was for the second batch of \\textit{C179-Gal4} + \\textit{Raptor/Tsc1} knockdown crosses.\n\n<<data-input, echo=FALSE>>=\nbirths_worksheet_location <- 'https://docs.google.com/spreadsheet/pub?key=0Aitfmor6rCjYdHpHTk1BZVh0MFEtNDV6QVI2V2RWSEE&single=true&gid=0&output=csv' \nlarvae_worksheet_location <- 'https://docs.google.com/spreadsheet/pub?key=0Aitfmor6rCjYdDVMbEVRd2NLbEpTQUM3REpKSEY3ckE&single=true&gid=0&output=csv'\nmapping_file <- '../Data/gene_mapping.csv'\nmapping.data <- read.csv(mapping_file)\n\nbirth_file_name <- '../Data/Birth Data.csv'\ndownload.file(births_worksheet_location, birth_file_name, method=\"curl\")\nbirth_data <- read.csv(birth_file_name)\n\nlarvae_filename <- '../Data/Larvae Inspection Data.csv'\ndownload.file(larvae_worksheet_location, larvae_filename, method=\"curl\")\nlarvae_data <- read.csv(larvae_filename)\n@\n\nThese data are stored in \\verb+\\Sexpr{getwd()}+, with the raw data saved in \\verb+\\Sexpr{birth_file_name}+ for the births and \\verb+\\Sexpr{larvae_filename}+ for the larvae inspection.  This script was most recently run on \\Sexpr{date()}.\n\n\\section*{C179-GAL4 Driver}\n\nThis analysis is just for the C179 Driver.\n\n<<data-collection, echo=False>>=\nlibrary(reshape2)\ncombined_larvae_data <- merge(larvae_data, dcast(droplevels(subset(birth_data, Female != 'Mef-Gal4')), Female+Male+CrossName~Gender, value.var='Count', sum), by='CrossName', all=T)\ncombined_larvae_data$Live.Flies <- combined_larvae_data$Females + combined_larvae_data$Males\ncombined_larvae_data$Total.Larvae <- combined_larvae_data$Dead.Flies + combined_larvae_data$Empty.Larvae\n\n#sets a sum of zero to be NA if the total number of alive flies was zero\ncombined_larvae_data[combined_larvae_data$Live.Flies==0&!(is.na(combined_larvae_data$Live.Flies)),]$Live.Flies <- NA\ncombined_larvae_data[is.na(combined_larvae_data$Live.Flies),]$Females <- NA\ncombined_larvae_data[is.na(combined_larvae_data$Live.Flies),]$Males <- NA\n\ncombined_larvae_data$Dead.Larvae.pct <- combined_larvae_data$Dead.Flies/combined_larvae_data$Total.Larvae*100\ncombined_larvae_data$UAS <- as.factor(sapply(strsplit(as.character(combined_larvae_data$Male), '/'),\"[\", 1))\ncombined_larvae_data$Driver <- as.factor(sapply(strsplit(as.character(combined_larvae_data$Female), '/'),\"[\", 1))\n\nannotated_larvae_data <- merge(mapping.data, combined_larvae_data, by='UAS', all.y=T)\nannotated_larvae_data <- droplevels(annotated_larvae_data)\nannotated_larvae_data$UAS <- as.factor(annotated_larvae_data$UAS)\nannotated_larvae_data$UAS <- relevel(annotated_larvae_data$UAS, ref='36304')\n\n#this calculates the summary statistics for total number of flies\nlibrary(plyr)\ntotal_fly_summary <- ddply(subset(annotated_larvae_data, Driver=='C179-Gal4'), ~Gene+UAS, summarize,\n                        mean = mean(Live.Flies, na.rm=T),\n                        se = sd(Live.Flies, na.rm=T)/sqrt(length(Live.Flies)),\n                        sd = sd(Live.Flies, na.rm=T),\n                        rel.error = sd(Live.Flies, na.rm=T)/mean(Live.Flies, na.rm=T)*100,                          \n                        n = length(Live.Flies))\n#calculated just for males\ntotal_fly_summary_males <- ddply(subset(annotated_larvae_data, Driver=='C179-Gal4'), ~Gene+UAS, summarize,\n                        mean = mean(Males, na.rm=T),\n                        se = sd(Males, na.rm=T)/sqrt(length(Males)),\n                        sd = sd(Males, na.rm=T),\n                        rel.error = sd(Males, na.rm=T)/mean(Males, na.rm=T)*100,                          \n                        n = length(Males))\n\n#calculated just for females\ntotal_fly_summary_females <- ddply(subset(annotated_larvae_data, Driver=='C179-Gal4'), ~Gene+UAS, summarize,\n                        mean = mean(Females, na.rm=T),\n                        se = sd(Females, na.rm=T)/sqrt(length(Females)),\n                        sd = sd(Females, na.rm=T),\n                        rel.error = sd(Females, na.rm=T)/mean(Females, na.rm=T)*100,                          \n                        n = length(Females))\n\n#this calcualtes the summary statistics for total number of larvae\ntotal_larvae_summary <- ddply(subset(annotated_larvae_data, Driver=='C179-Gal4'), ~Gene+UAS, summarize,\n                        mean = mean(Total.Larvae, na.rm=T),\n                        se = sd(Total.Larvae, na.rm=T)/sqrt(length(Total.Larvae)),\n                        sd = sd(Total.Larvae, na.rm=T),\n                        rel.error = sd(Total.Larvae, na.rm=T)/mean(Total.Larvae, na.rm=T)*100,                              \n                        n = length(Total.Larvae))\n\n#this calcualtes the summary statistics for dead larvae \ndead_larvae_summary <- ddply(subset(annotated_larvae_data, Driver=='C179-Gal4'), ~Gene+UAS, summarize,\n                        mean = mean(Dead.Larvae.pct, na.rm=T),\n                        se = sd(Dead.Larvae.pct, na.rm=T)/sqrt(length(Dead.Larvae.pct)),\n                        sd = sd(Dead.Larvae.pct, na.rm=T),\n                        rel.error = sd(Dead.Larvae.pct, na.rm=T)/mean(Dead.Larvae.pct, na.rm=T)*100,\n                        n = length(Dead.Larvae.pct))\n@\n\n<<total-larvae-statistics, echo=FALSE>>=\n#perform anova testing first for an effect of the driver, then for an effect of the shRNAs\ntotal.larvae.aov <- aov(Total.Larvae~Driver*UAS, data=annotated_larvae_data)\n@\n\n\\section*{Analysis of Larvae}\n\nWe inspected the pupae from vials, 21 days after the cross was set up and counted how many pupae were present, and how many had dead flies in them.  These data are summarized in  Table \\ref{tab:total-larvae-summary} and in Figure \\ref{fig:total-larvae-barplot}.  To analyse these data, first we did an ANOVA testing for whether the UAS has an effect on the percentage of dead larvae.  The p-value for that comparason is \\textbf{\\Sexpr{round(summary(total.larvae.aov)[[1]][[\"Pr(>F)\"]][2],3)}} for the UAS.  The results of this ANOVA are shown in Table \\ref{tab:total-larvae-anova}.  To test if the driver alone had an effect with did a Student's t-test comparing the +/+ and \\textit{C179/+} progeny.  The p-value for the Driver having an effect is \\textbf{\\Sexpr{round(t.test(Total.Larvae~Driver, subset(annotated_larvae_data, UAS==36304))$p.value, 3)}}.  This indicated that there was no significant effect on the number of larvae.\n\n<<label=larvae-summary-tables,echo=FALSE,results=tex>>=\nrequire(xtable)\nprint(xtable(total_larvae_summary, caption=\"Summary of the Number of Larvae by Driver and UAS\", label=\"tab:total-larvae-summary\"), include.rownames=F)\nprint(xtable(total.larvae.aov, caption=\"ANOVA for the Number of Larvae by Driver and UAS\", label=\"tab:total-larvae-anova\"))\n@\n\n\\begin{figure}\n\\begin{center}\n<<label=total-larvae-barplot,fig=TRUE,echo=FALSE>>=\nymax <- max(total_larvae_summary$mean+total_larvae_summary$se, na.rm=T)\nplot <- barplot(total_larvae_summary$mean,\n        beside=T, las=1,\n        ylim=c(0,ymax),\n        names.arg=total_larvae_summary$UAS,\n        col=total_larvae_summary$Gene,\n        ylab=\"Total Number of Larvae\",\n        xlab=\"shRNA Clone\",\n        main=\"Total Number of Larvae Using the C179-GAL4 Driver\")\n\nlegend(\"top\", levels(total_larvae_summary$Gene), fill= palette()[1:length(levels(total_larvae_summary$Gene))], bty='n')\n\nsuperpose.eb <- \n function (x, y, ebl, ebu = ebl, length = 0.08, ...) \n arrows(x, y + ebu, x, y - ebl, angle = 90, code = 3, \n length = length, ...)\n\nsuperpose.eb(plot, \n             total_larvae_summary$mean,\n             total_larvae_summary$se)\n@\n\\end{center}\n\\caption{Total number of larvae counted.  Presented as mean +/- standard error.}\n\\label{fig:total-larvae-barplot}\n\\end{figure}\n\n\n\\section*{Analysis of Dead Larvae}\n\n\\begin{figure}\n\\begin{center}\n<<label=dead-larvae-barplot,fig=TRUE,echo=FALSE>>=\nymax <- max(dead_larvae_summary$mean+dead_larvae_summary$se, na.rm=T)\nplot <- barplot(dead_larvae_summary$mean,\n        beside=T, las=1,\n        ylim=c(0,ymax),\n        names.arg=dead_larvae_summary$UAS,\n        col=dead_larvae_summary$Gene,\n        ylab=\"Percent of Dead Larvae\",\n        xlab=\"shRNA Clone\",\n        main=\"Percent of Dead Larvae Using the C179-GAL4 Driver\")\n\nlegend(\"topleft\", levels(dead_larvae_summary$Gene), fill= palette()[1:length(levels(dead_larvae_summary$Gene))], bty='n')\n\nsuperpose.eb(plot, \n             dead_larvae_summary$mean,\n             dead_larvae_summary$se)\n@\n\\end{center}\n\\caption{Proportion of larvae with dead flies.  Presented as mean +/- standard error.}\n\\label{fig:dead-larvae-barplot}\n\\end{figure}\n\n<<dead-larvae-statistics, echo=FALSE>>=\n#perform anova testing first for an effect of the driver, then for an effect of the shRNAs\nlarvae.aov <- aov(Dead.Larvae.pct~Driver*UAS, data=annotated_larvae_data)\nlarvae.aov.c179 <- aov(Dead.Larvae.pct~UAS, data=subset(annotated_larvae_data, Driver=='C179-Gal4'))\n#did dunnet test vs the control\nlibrary(multcomp)\nlarvae.dunnett <- glht(larvae.aov.c179, linfct=mcp(UAS=\"Dunnett\"))\n#made a table with the dunnet test results\nlarvae.dunnett.summary <- cbind(summary(larvae.dunnett)$test$coefficients, summary(larvae.dunnett)$test$pvalues)\ncolnames(larvae.dunnett.summary) <- c(\"Effect Size (%)\", \"p-value\")\n@\n\nA summary of the percent of dead larvae for each cross is shown in Table \\ref{tab:dead-larvae-summary} and in Figure \\ref{fig:dead-larvae-barplot}.\nTo analyse these data, first we did an ANOVA testing for whether the UAS has an effect on the percentage of dead larvae.  The p-value for that comparason is \\textbf{\\Sexpr{round(summary(larvae.aov)[[1]][[\"Pr(>F)\"]][2],9)}} for the UAS.  The results of this ANOVA are shown in Table \\ref{tab:dead-larvae-anova}.  To test if the driver alone had an effect with did a Student's t-test comparing the +/+ and \\textit{C179/+} progeny.  The p-value for the Driver having an effect is \\textbf{\\Sexpr{round(t.test(Dead.Larvae.pct~Driver, subset(annotated_larvae_data, UAS=36304))$p.value, 6)}}.  We therefore excluded the +/+ progeny from the analysis and compared with the \\textit{C179-Gal4/+} progeny as a control.  \n\nThe ANOVA for this comparason yielded a p-value for the UAS of \\textbf{\\Sexpr{round(summary(larvae.aov.c179)[[1]][[\"Pr(>F)\"]][1],6)}}.  The results of this ANOVA are in Table \\ref{tab:dead-larvae-anova-c179}.  Since this ANOVA was significant, we did a post-hoc test to look at each strain relative to the control.  To test for differences compared to the \\textit{C179-GAL4/+} control strain, we did a Dunnett's test.  The results of this test are shown in Table \\ref{tab:dead-larvae-dunnett}.  \n\n\n<<label=larvae-summary-tables,echo=FALSE,results=tex>>=\nrequire(xtable)\nprint(xtable(dead_larvae_summary, caption=\"Summary of Percent of Dead Larvae by Driver and UAS\", label=\"tab:dead-larvae-summary\"), include.rownames=F)\nprint(xtable(larvae.aov, caption=\"ANOVA for Percent of Dead Larvae by Driver and UAS\", label=\"tab:dead-larvae-anova\"))\nprint(xtable(larvae.aov.c179, caption=\"ANOVA for Percent of Dead Larvae by UAS\", label=\"tab:dead-larvae-anova-c179\"))\nprint(xtable(larvae.dunnett.summary, caption=\"Dunnett's Test for the Percent of Dead Larvae Comparing to Control (C179-Gal4/+)\", label=\"tab:dead-larvae-dunnett\", digits=c(0,1,7)))\n@\n     \n\\section*{Analysis of Total Number of Flies}\n\n<<total-fly-statistics, echo=FALSE>>=\n#perform anova testing first for an effect of the driver, then for an effect of the shRNAs\ntotal.flies.aov <- aov(Live.Flies~Driver*UAS, data=annotated_larvae_data)\nrestricted.flies.aov <- aov(Live.Flies~UAS, data=subset(annotated_larvae_data, Driver=='C179-Gal4'))\ntotal.flies.dunnett <- glht(restricted.flies.aov , linfct=mcp(UAS=\"Dunnett\"))\n#made a table with the dunnet test results\nfly.dunnett.summary <- cbind(summary(total.flies.dunnett)$test$coefficients, summary(total.flies.dunnett)$test$pvalues)\ncolnames(fly.dunnett.summary) <- c(\"Effect Size (%)\", \"p-value\")\n@\n\n\\begin{figure}\n\\begin{center}\n<<label=total-fly-barplot,fig=TRUE,echo=FALSE>>=\nymax <- max(total_fly_summary$mean+total_fly_summary$se, na.rm=T)\nplot <- barplot(total_fly_summary$mean,\n        beside=T, las=1,\n        ylim=c(0,ymax),\n        names.arg=total_fly_summary$UAS,\n        col=total_fly_summary$Gene,\n        ylab=\"Total Number of Flies\",\n        xlab=\"shRNA Clone\",\n        main=\"Total Number of Flies for the C179-GAL4 Driver\")\n\nlegend(\"top\", levels(total_fly_summary$Gene), fill= palette()[1:length(levels(total_fly_summary$Gene))], bty='n')\n\nsuperpose.eb(plot, \n             total_fly_summary$mean,\n             total_fly_summary$se)\n@\n\\end{center}\n\\caption{Total number of flies counted.  Presented as mean +/- standard error.}\n\\label{fig:total-flies-barplot}\n\\end{figure}\n\nWe inspected the total number of flies eclosed up to 21 days after the cross was set up.  These data are summarized in  Table \\ref{tab:total-flies-summary} and in Figure \\ref{fig:total-flies-barplot}.  To analyse these data, first we did an ANOVA testing for whether the UAS has an effect on the number of eclosed flies.  The p-value for that comparason is \\textbf{\\Sexpr{round(summary(total.flies.aov)[[1]][[\"Pr(>F)\"]][2],4)}} for the UAS.  The results of this ANOVA are shown in Table \\ref{tab:total-flies-anova}.  To test if the driver alone had an effect with did a Student's t-test comparing the +/+ and \\textit{C179/+} progeny.  The p-value for the Driver having an effect is \\textbf{\\Sexpr{round(t.test(Live.Flies~Driver, subset(annotated_larvae_data, UAS=36304))$p.value, 3)}}.  \n\nDue to the significant ANOVA we performed a post-hoc Dunnett's test using the \\textit{C179/+} progeny as the controls.  An ANOVA analysis excluding the +/+ flies had a p-value of \\textbf{\\Sexpr{round(summary(restricted.flies.aov)[[1]][[\"Pr(>F)\"]][1],7)}} for the UAS.  The results of that test are in Table \\ref{tab:total-flies-dunnett}.  This test indicates that each of the three Raptor shRNA knockdowns cause a reduction in the number of flies.\n\n<<label=total-fly-summary-tables,echo=FALSE,results=tex>>=\nprint(xtable(total_fly_summary, caption=\"Summary of the Number of Flies by Driver and UAS\", label=\"tab:total-flies-summary\"), include.rownames=F)\nprint(xtable(total.flies.aov, caption=\"ANOVA for the Number of Flies by Driver and UAS\", label=\"tab:total-flies-anova\"))\nprint(xtable(fly.dunnett.summary, caption=\"Dunnett's Test for the Number of Flies Comparing to Control (C179-Gal4/+)\", label=\"tab:total-flies-dunnett\", digits=c(0,1,7)))\n@\n\n\\subsection*{Analysis of Number of Flies by Gender}\n\n<<total-fly-statistics-gender, echo=FALSE>>=\n#perform anova testing first for an effect of the driver, then for an effect of the shRNAs\ntotal.flies.aov.males <- aov(Males~Driver*UAS, data=annotated_larvae_data)\ntotal.flies.aov.females <- aov(Females~Driver*UAS, data=annotated_larvae_data)\n\nrestricted.flies.aov.males <- aov(Males~UAS, data=subset(annotated_larvae_data, Driver=='C179-Gal4'))\nrestricted.flies.aov.females <- aov(Females~UAS, data=subset(annotated_larvae_data, Driver=='C179-Gal4'))\n\ntotal.flies.dunnett.males <- glht(restricted.flies.aov.males , linfct=mcp(UAS=\"Dunnett\"))\ntotal.flies.dunnett.females <- glht(restricted.flies.aov.females , linfct=mcp(UAS=\"Dunnett\"))\n#made a table with the dunnet test results\nfly.dunnett.summary.gendered <- cbind(summary(total.flies.dunnett.males)$test$coefficients, \n                             summary(total.flies.dunnett.males)$test$pvalues,\n                             summary(total.flies.dunnett.females)$test$coefficients, \n                             summary(total.flies.dunnett.females)$test$pvalues)\ncolnames(fly.dunnett.summary.gendered) <- c(\"Male Effect Size (%)\", \"Male p-value\",\"Female Effect Size (%)\", \"Female p-value\")\n@\n\nFor the flies which had been born, we could separate these data based on gender.  The separated data is summarized in Tables \\ref{tab:total-flies-summary-males} and \\ref{tab:total-flies-summary-females}.  These data are graphed in Figure \\ref{fig:total-flies-barplot-gendered}.  \n\nFor Males, first we did an ANOVA testing for whether the UAS has an effect on the number of eclosed flies.  The p-value for that comparason is \\textbf{\\Sexpr{round(summary(total.flies.aov.males)[[1]][[\"Pr(>F)\"]][2],10)}} for the UAS.  The results of this ANOVA are shown in Table \\ref{tab:total-flies-anova-males}.  To test if the driver alone had an effect with did a Student's t-test comparing the +/+ and \\textit{C179/+} progeny.  The p-value for the Driver having an effect is \\textbf{\\Sexpr{round(t.test(Males~Driver, subset(annotated_larvae_data, UAS=36304))$p.value, 3)}}. \n\nFor Females, first we did an ANOVA testing for whether the UAS has an effect on the number of eclosed flies.  The p-value for that comparason is \\textbf{\\Sexpr{round(summary(total.flies.aov.females)[[1]][[\"Pr(>F)\"]][2],6)}} for the UAS.  The results of this ANOVA are shown in Table \\ref{tab:total-flies-anova-females}.  To test if the driver alone had an effect with did a Student's t-test comparing the +/+ and \\textit{C179/+} progeny.  The p-value for the Driver having an effect is \\textbf{\\Sexpr{round(t.test(Females~Driver, subset(annotated_larvae_data, UAS=36304))$p.value, 3)}}. \n\nDue to the significant ANOVA we performed a post-hoc Dunnett's test using the \\textit{C179/+} progeny as the controls.  An ANOVA analysis excluding the +/+ flies had a p-value of \\textbf{\\Sexpr{round(summary(restricted.flies.aov.males)[[1]][[\"Pr(>F)\"]][1],9)}} for the UAS for males and a p-value of \\textbf{\\Sexpr{round(summary(restricted.flies.aov.females)[[1]][[\"Pr(>F)\"]][1],5)}} for the UAS for the females.  The results of that test are in Tables \\ref{tab:total-flies-dunnett-gendered}.  This test indicates that each of the three Raptor shRNA knockdowns cause a reduction in the number of male flies, but only 34814 had significantly less females.\n\n<<label=total-fly-summary-gender-tables,echo=FALSE,results=tex>>=\nprint(xtable(total_fly_summary_males, caption=\"Summary of the Number of Male Flies by Driver and UAS\", label=\"tab:total-flies-summary-males\"), include.rownames=F)\nprint(xtable(total_fly_summary_females, caption=\"Summary of the Number of Female Flies by Driver and UAS\", label=\"tab:total-flies-summary-females\"), include.rownames=F)\nprint(xtable(total.flies.aov.males, caption=\"ANOVA for the Number of Male Flies by Driver and UAS\", label=\"tab:total-flies-anova-males\"))\nprint(xtable(total.flies.aov.females, caption=\"ANOVA for the Number of Female Flies by Driver and UAS\", label=\"tab:total-flies-anova-females\"))\nprint(xtable(fly.dunnett.summary.gendered, caption=\"Dunnett's Test for the Number of Males and Females Comparing to Control (C179-Gal4/+)\", label=\"tab:total-flies-dunnett-gendered\", digits=c(0,1,7,1,7)))\n@\n\n\\begin{figure}\n\\begin{center}\n<<label=total-fly-barplot-gendered,fig=TRUE,echo=FALSE>>=\npar(mfrow=c(2,1))\nymax <- max(total_fly_summary_males$mean+total_fly_summary_males$se, na.rm=T)\nplot <- barplot(total_fly_summary_males$mean,\n        beside=T, las=1,\n        ylim=c(0,ymax),\n        names.arg=total_fly_summary_males$UAS,\n        col=total_fly_summary_males$Gene,\n        ylab=\"Total Number of Flies\",\n        xlab=\"shRNA Clone\",\n        main=\"Total Number of Male Flies\")\n\nlegend(\"top\", levels(total_fly_summary_males$Gene), fill= palette()[1:length(levels(total_fly_summary_males$Gene))], bty='n')\n\nsuperpose.eb(plot, \n             total_fly_summary_males$mean,\n             total_fly_summary_males$se)\n\nymax <- max(total_fly_summary_females$mean+total_fly_summary_females$se, na.rm=T)\nplot <- barplot(total_fly_summary_females$mean,\n        beside=T, las=1,\n        ylim=c(0,ymax),\n        names.arg=total_fly_summary_females$UAS,\n        col=total_fly_summary_females$Gene,\n        ylab=\"Total Number of Flies\",\n        xlab=\"shRNA Clone\",\n        main=\"Total Number of Female Flies\")\n\nsuperpose.eb(plot, \n             total_fly_summary_females$mean,\n             total_fly_summary_females$se)\n@\n\\end{center}\n\\caption{Total number of flies counted, separated by gender.  Presented as mean +/- standard error.}\n\\label{fig:total-flies-barplot-gendered}\n\\end{figure}\n\\pagebreak\n     \n\\section*{Mef-GAL4 Driver}\n\n\nThis analysis is just for the \\textit{Mef1c-GAL4} Driver.\n\n<<data-collection-mef, echo=False>>=\ncombined_larvae_data_mef <- merge(larvae_data, dcast(droplevels(subset(birth_data, Female != 'C179-Gal4')), Female+Male+CrossName~Gender, value.var='Count', sum), by='CrossName', all=T)\ncombined_larvae_data_mef$Live.Flies <- combined_larvae_data_mef$Females + combined_larvae_data_mef$Males\ncombined_larvae_data_mef$Total.Larvae <- combined_larvae_data_mef$Dead.Flies + combined_larvae_data_mef$Empty.Larvae\n\n#sets a sum of zero to be NA if the total number of alive flies was zero\ncombined_larvae_data_mef[combined_larvae_data_mef$Live.Flies==0&!(is.na(combined_larvae_data_mef$Live.Flies)),]$Live.Flies <- NA\ncombined_larvae_data_mef[is.na(combined_larvae_data_mef$Live.Flies),]$Females <- NA\ncombined_larvae_data_mef[is.na(combined_larvae_data_mef$Live.Flies),]$Males <- NA\n\ncombined_larvae_data_mef$Dead.Larvae.pct <- combined_larvae_data_mef$Dead.Flies/combined_larvae_data_mef$Total.Larvae*100\ncombined_larvae_data_mef$UAS <- as.factor(sapply(strsplit(as.character(combined_larvae_data_mef$Male), '/'),\"[\", 1))\ncombined_larvae_data_mef$Driver <- as.factor(sapply(strsplit(as.character(combined_larvae_data_mef$Female), '/'),\"[\", 1))\n\nannotated_larvae_data_mef <- merge(mapping.data, combined_larvae_data_mef, by='UAS', all.y=T)\nannotated_larvae_data_mef <- droplevels(annotated_larvae_data_mef)\nannotated_larvae_data_mef$UAS <- as.factor(annotated_larvae_data_mef$UAS)\nannotated_larvae_data_mef$UAS <- relevel(annotated_larvae_data_mef$UAS, ref='36304')\n\n#this calculates the summary statistics for total number of flies\nlibrary(plyr)\ntotal_fly_summary_mef <- ddply(subset(annotated_larvae_data_mef, Driver=='Mef-Gal4'), ~Gene+UAS, summarize,\n                        mean = mean(Live.Flies, na.rm=T),\n                        se = sd(Live.Flies, na.rm=T)/sqrt(length(Live.Flies)),\n                        sd = sd(Live.Flies, na.rm=T),\n                        rel.error = sd(Live.Flies, na.rm=T)/mean(Live.Flies, na.rm=T)*100,                          \n                        n = length(Live.Flies))\n#calculated just for males\ntotal_fly_summary_males_mef <- ddply(subset(annotated_larvae_data_mef, Driver=='Mef-Gal4'), ~Gene+UAS, summarize,\n                        mean = mean(Males, na.rm=T),\n                        se = sd(Males, na.rm=T)/sqrt(length(Males)),\n                        sd = sd(Males, na.rm=T),\n                        rel.error = sd(Males, na.rm=T)/mean(Males, na.rm=T)*100,                          \n                        n = length(Males))\n\n#calculated just for females\ntotal_fly_summary_females_mef <- ddply(subset(annotated_larvae_data_mef, Driver=='Mef-Gal4'), ~Gene+UAS, summarize,\n                        mean = mean(Females, na.rm=T),\n                        se = sd(Females, na.rm=T)/sqrt(length(Females)),\n                        sd = sd(Females, na.rm=T),\n                        rel.error = sd(Females, na.rm=T)/mean(Females, na.rm=T)*100,                          \n                        n = length(Females))\n\n#this calcualtes the summary statistics for total number of larvae\ntotal_larvae_summary_mef <- ddply(subset(annotated_larvae_data_mef, Driver=='Mef-Gal4'), ~Gene+UAS, summarize,\n                        mean = mean(Total.Larvae, na.rm=T),\n                        se = sd(Total.Larvae, na.rm=T)/sqrt(length(Total.Larvae)),\n                        sd = sd(Total.Larvae, na.rm=T),\n                        rel.error = sd(Total.Larvae, na.rm=T)/mean(Total.Larvae, na.rm=T)*100,                              \n                        n = length(Total.Larvae))\n\n#this calcualtes the summary statistics for dead larvae \ndead_larvae_summary_mef <- ddply(subset(annotated_larvae_data_mef, Driver=='Mef-Gal4'), ~Gene+UAS, summarize,\n                        mean = mean(Dead.Larvae.pct, na.rm=T),\n                        se = sd(Dead.Larvae.pct, na.rm=T)/sqrt(length(Dead.Larvae.pct)),\n                        sd = sd(Dead.Larvae.pct, na.rm=T),\n                        rel.error = sd(Dead.Larvae.pct, na.rm=T)/mean(Dead.Larvae.pct, na.rm=T)*100,\n                        n = length(Dead.Larvae.pct))\n@\n\n<<total-larvae-statistics, echo=FALSE>>=\n#perform anova testing first for an effect of the driver, then for an effect of the shRNAs\ntotal.larvae.aov_mef <- aov(Total.Larvae~Driver*UAS, data=annotated_larvae_data_mef)\n@\n\n\\pagebreak\n\\section*{Analysis of Larvae}\n\nWe inspected the pupae from vials, 21 days after the cross was set up and counted how many pupae were present, and how many had dead flies in them.  These data are summarized in  Table \\ref{tab:total-larvae-summary-mef} and in Figure \\ref{fig:total-larvae-barplot-mef}.  To analyse these data, first we did an ANOVA testing for whether the UAS has an effect on the percentage of dead larvae.  The p-value for that comparason is \\textbf{\\Sexpr{round(summary(total.larvae.aov_mef)[[1]][[\"Pr(>F)\"]][2],3)}} for the UAS.  The results of this ANOVA are shown in Table \\ref{tab:total-larvae-anova-mef}.  To test if the driver alone had an effect with did a Student's t-test comparing the +/+ and \\textit{Mef/+} progeny.  The p-value for the Driver having an effect is \\textbf{\\Sexpr{round(t.test(Total.Larvae~Driver, subset(annotated_larvae_data_mef, UAS==36304))$p.value, 3)}}.  This indicated that there was no significant effect on the number of larvae.\n\n<<label=larvae-summary-tables,echo=FALSE,results=tex>>=\nrequire(xtable)\nprint(xtable(total_larvae_summary_mef, caption=\"Summary of the Number of Larvae by Driver and UAS\", label=\"tab:total-larvae-summary-mef\"), include.rownames=F)\nprint(xtable(total.larvae.aov_mef, caption=\"ANOVA for the Number of Larvae by Driver and UAS\", label=\"tab:total-larvae-anova-mef\"))\n@\n\n\\begin{figure}\n\\begin{center}\n<<label=total-larvae-barplot-mef,fig=TRUE,echo=FALSE>>=\nymax <- max(total_larvae_summary_mef$mean+total_larvae_summary_mef$se, na.rm=T)\nplot <- barplot(total_larvae_summary_mef$mean,\n        beside=T, las=1,\n        ylim=c(0,ymax),\n        names.arg=total_larvae_summary_mef$UAS,\n        col=total_larvae_summary_mef$Gene,\n        ylab=\"Total Number of Larvae\",\n        xlab=\"shRNA Clone\",\n        main=\"Total Number of Larvae Using the Mef-GAL4 Driver\")\n\nlegend(\"top\", levels(total_larvae_summary_mef$Gene), fill= palette()[1:length(levels(total_larvae_summary_mef$Gene))], bty='n')\n\nsuperpose.eb(plot, \n             total_larvae_summary_mef$mean,\n             total_larvae_summary_mef$se)\n@\n\\end{center}\n\\caption{Total number of larvae counted.  Presented as mean +/- standard error.}\n\\label{fig:total-larvae-barplot-mef}\n\\end{figure}\n\n\\pagebreak\n\\section*{Analysis of Dead Larvae}\n\n\\begin{figure}\n\\begin{center}\n<<label=dead-larvae-barplot-mef,fig=TRUE,echo=FALSE>>=\nymax <- max(100)\nplot <- barplot(dead_larvae_summary_mef$mean,\n        beside=T, las=1,\n        ylim=c(0,ymax),\n        names.arg=dead_larvae_summary_mef$UAS,\n        col=dead_larvae_summary_mef$Gene,\n        ylab=\"Percent of Dead Larvae\",\n        xlab=\"shRNA Clone\",\n        main=\"Percent of Dead Larvae Using the Mef-GAL4 Driver\")\n\nlegend(\"topleft\", levels(dead_larvae_summary_mef$Gene), fill= palette()[1:length(levels(dead_larvae_summary_mef$Gene))], bty='n')\n\nsuperpose.eb(plot, \n             dead_larvae_summary_mef$mean,\n             dead_larvae_summary_mef$se)\n@\n\\end{center}\n\\caption{Proportion of larvae with dead flies.  Presented as mean +/- standard error.}\n\\label{fig:dead-larvae-barplot-mef}\n\\end{figure}\n\n<<dead-larvae-statistics-mef, echo=FALSE>>=\n#perform anova testing first for an effect of the driver, then for an effect of the shRNAs\nlarvae.aov_mef <- aov(Dead.Larvae.pct~Driver*UAS, data=annotated_larvae_data_mef)\nlarvae.aov.Mef_mef <- aov(Dead.Larvae.pct~UAS, data=subset(annotated_larvae_data_mef, Driver=='Mef-Gal4'))\n#did dunnet test vs the control\nlibrary(multcomp)\nlarvae.dunnett_mef <- glht(larvae.aov.Mef_mef, linfct=mcp(UAS=\"Dunnett\"))\n#made a table with the dunnet test results\nlarvae.dunnett.summary_mef <- cbind(summary(larvae.dunnett_mef)$test$coefficients, summary(larvae.dunnett_mef)$test$pvalues)\ncolnames(larvae.dunnett.summary_mef) <- c(\"Effect Size (%)\", \"p-value\")\n@\n\nA summary of the percent of dead larvae for each cross is shown in Table \\ref{tab:dead-larvae-summary-mef} and in Figure \\ref{fig:dead-larvae-barplot}.\nTo analyse these data, first we did an ANOVA testing for whether the UAS has an effect on the percentage of dead larvae.  The p-value for that comparason is \\textbf{\\Sexpr{round(summary(larvae.aov_mef)[[1]][[\"Pr(>F)\"]][2],3)}} for the UAS.  The results of this ANOVA are shown in Table \\ref{tab:dead-larvae-anova-mef}.  To test if the driver alone had an effect with did a Student's t-test comparing the +/+ and \\textit{Mef/+} progeny.  The p-value for the Driver having an effect is \\textbf{\\Sexpr{round(t.test(Dead.Larvae.pct~Driver, subset(annotated_larvae_data_mef, UAS=36304))$p.value, 3)}}.  We therefore excluded the +/+ progeny from the analysis and compared with the \\textit{Mef-Gal4/+} progeny as a control.  \n\nThe ANOVA for this comparason yielded a p-value for the UAS of \\textbf{\\Sexpr{round(summary(larvae.aov.Mef_mef)[[1]][[\"Pr(>F)\"]][1],3)}}.  The results of this ANOVA are in Table \\ref{tab:dead-larvae-anova-Mef}.  Since this ANOVA was significant, we did a post-hoc test to look at each strain relative to the control.  To test for differences compared to the \\textit{Mef-GAL4/+} control strain, we did a Dunnett's test.  The results of this test are shown in Table \\ref{tab:dead-larvae-dunnett-mef}.  \n\n\n<<label=larvae-summary-tables,echo=FALSE,results=tex>>=\nrequire(xtable)\nprint(xtable(dead_larvae_summary_mef, caption=\"Summary of Percent of Dead Larvae by Driver and UAS\", label=\"tab:dead-larvae-summary-mef\"), include.rownames=F)\nprint(xtable(larvae.aov_mef, caption=\"ANOVA for Percent of Dead Larvae by Driver and UAS\", label=\"tab:dead-larvae-anova-mef\"))\nprint(xtable(larvae.aov.Mef_mef, caption=\"ANOVA for Percent of Dead Larvae by UAS\", label=\"tab:dead-larvae-anova-Mef\"))\nprint(xtable(larvae.dunnett.summary_mef, caption=\"Dunnett's Test for the Percent of Dead Larvae Comparing to Control (Mef-Gal4/+)\", label=\"tab:dead-larvae-dunnett-mef\", digits=c(0,1,7)))\n@\n\\pagebreak\n\\section*{Analysis of Total Number of Flies}\n\n<<total-fly-statistics-mef, echo=FALSE>>=\n#perform anova testing first for an effect of the driver, then for an effect of the shRNAs\ntotal.flies.aov_mef <- aov(Live.Flies~Driver*UAS, data=annotated_larvae_data_mef)\nrestricted.flies.aov_mef <- aov(Live.Flies~UAS, data=subset(annotated_larvae_data_mef, Driver=='Mef-Gal4'))\ntotal.flies.dunnett_mef <- glht(restricted.flies.aov_mef , linfct=mcp(UAS=\"Dunnett\"))\n#made a table with the dunnet test results\nfly.dunnett.summary_mef <- cbind(summary(total.flies.dunnett_mef)$test$coefficients, summary(total.flies.dunnett_mef)$test$pvalues)\ncolnames(fly.dunnett.summary_mef) <- c(\"Effect Size (%)\", \"p-value\")\n@\n\n\\begin{figure}\n\\begin{center}\n<<label=total-fly-barplot-mef,fig=TRUE,echo=FALSE>>=\nymax <- max(total_fly_summary_mef$mean+total_fly_summary_mef$se, na.rm=T)\nplot <- barplot(total_fly_summary_mef$mean,\n        beside=T, las=1,\n        ylim=c(0,ymax),\n        names.arg=total_fly_summary_mef$UAS,\n        col=total_fly_summary_mef$Gene,\n        ylab=\"Total Number of Flies\",\n        xlab=\"shRNA Clone\",\n        main=\"Total Number of Flies for the Mef-GAL4 Driver\")\n\nlegend(\"top\", levels(total_fly_summary_mef$Gene), fill= palette()[1:length(levels(total_fly_summary_mef$Gene))], bty='n')\n\nsuperpose.eb(plot, \n             total_fly_summary_mef$mean,\n             total_fly_summary_mef$se)\n@\n\\end{center}\n\\caption{Total number of flies counted.  Presented as mean +/- standard error.}\n\\label{fig:total-flies-barplot-mef}\n\\end{figure}\n\nWe inspected the total number of flies eclosed up to 21 days after the cross was set up.  These data are summarized in  Table \\ref{tab:total-flies-summary-mef} and in Figure \\ref{fig:total-flies-barplot-mef}.  To analyse these data, first we did an ANOVA testing for whether the UAS has an effect on the number of eclosed flies.  The p-value for that comparason is \\textbf{\\Sexpr{round(summary(total.flies.aov_mef)[[1]][[\"Pr(>F)\"]][2],3)}} for the UAS.  The results of this ANOVA are shown in Table \\ref{tab:total-flies-anova}.  To test if the driver alone had an effect with did a Student's t-test comparing the +/+ and \\textit{Mef/+} progeny.  The p-value for the Driver having an effect is \\textbf{\\Sexpr{round(t.test(Live.Flies~Driver, subset(annotated_larvae_data_mef, UAS=36304))$p.value, 3)}}.  \n\nDue to the significant ANOVA we performed a post-hoc Dunnett's test using the \\textit{Mef/+} progeny as the controls.  An ANOVA analysis excluding the +/+ flies had a p-value of \\textbf{\\Sexpr{round(summary(restricted.flies.aov_mef)[[1]][[\"Pr(>F)\"]][1],3)}} for the UAS.  The results of that test are in Table \\ref{tab:total-flies-dunnett-mef}.  This test indicates that each of the three Raptor shRNA knockdowns cause a reduction in the number of flies.\n\n<<label=total-fly-summary-tables-mef,echo=FALSE,results=tex>>=\nprint(xtable(total_fly_summary_mef, caption=\"Summary of the Number of Flies by Driver and UAS\", label=\"tab:total-flies-summary-mef\"), include.rownames=F)\nprint(xtable(total.flies.aov_mef, caption=\"ANOVA for the Number of Flies by Driver and UAS\", label=\"tab:total-flies-anova-mef\"))\nprint(xtable(fly.dunnett.summary_mef, caption=\"Dunnett's Test for the Number of Flies Comparing to Control (Mef-Gal4/+)\", label=\"tab:total-flies-dunnett-mef\", digits=c(0,1,7)))\n@\n\n\\subsection*{Analysis of Number of Flies by Gender}\n\n<<total-fly-statistics-gender, echo=FALSE>>=\n#perform anova testing first for an effect of the driver, then for an effect of the shRNAs\ntotal.flies.aov.males_mef <- aov(Males~Driver*UAS, data=annotated_larvae_data_mef)\ntotal.flies.aov.females_mef <- aov(Females~Driver*UAS, data=annotated_larvae_data_mef)\n\nrestricted.flies.aov.males_mef <- aov(Males~UAS, data=subset(annotated_larvae_data_mef, Driver=='Mef-Gal4'))\nrestricted.flies.aov.females_mef <- aov(Females~UAS, data=subset(annotated_larvae_data_mef, Driver=='Mef-Gal4'))\n\ntotal.flies.dunnett.males_mef <- glht(restricted.flies.aov.males_mef , linfct=mcp(UAS=\"Dunnett\"))\ntotal.flies.dunnett.females_mef <- glht(restricted.flies.aov.females_mef , linfct=mcp(UAS=\"Dunnett\"))\n#made a table with the dunnet test results\nfly.dunnett.summary.gendered_mef <- cbind(summary(total.flies.dunnett.males_mef)$test$coefficients, \n                             summary(total.flies.dunnett.males_mef)$test$pvalues,\n                             summary(total.flies.dunnett.females_mef)$test$coefficients, \n                             summary(total.flies.dunnett.females_mef)$test$pvalues)\ncolnames(fly.dunnett.summary.gendered_mef) <- c(\"Male Effect Size (%)\", \"Male p-value\",\"Female Effect Size (%)\", \"Female p-value\")\n@\n\nFor the flies which had been born, we could separate these data based on gender.  The separated data is summarized in Tables \\ref{tab:total-flies-summary-males} and \\ref{tab:total-flies-summary-females}.  These data are graphed in Figure \\ref{fig:total-flies-barplot-gendered}.  \n\nFor Males, first we did an ANOVA testing for whether the UAS has an effect on the number of eclosed flies.  The p-value for that comparason is \\textbf{\\Sexpr{round(summary(total.flies.aov.males_mef)[[1]][[\"Pr(>F)\"]][2],3)}} for the UAS.  The results of this ANOVA are shown in Table \\ref{tab:total-flies-anova-males-mef}.  To test if the driver alone had an effect with did a Student's t-test comparing the +/+ and \\textit{Mef/+} progeny.  The p-value for the Driver having an effect is \\textbf{\\Sexpr{round(t.test(Males~Driver, subset(annotated_larvae_data_mef, UAS=36304))$p.value, 3)}}. \n\nFor Females, first we did an ANOVA testing for whether the UAS has an effect on the number of eclosed flies.  The p-value for that comparason is \\textbf{\\Sexpr{round(summary(total.flies.aov.females_mef)[[1]][[\"Pr(>F)\"]][2],3)}} for the UAS.  The results of this ANOVA are shown in Table \\ref{tab:total-flies-anova-females}.  To test if the driver alone had an effect with did a Student's t-test comparing the +/+ and \\textit{Mef/+} progeny.  The p-value for the Driver having an effect is \\textbf{\\Sexpr{round(t.test(Females~Driver, subset(annotated_larvae_data_mef, UAS=36304))$p.value, 3)}}. \n\nDue to the significant ANOVA we performed a post-hoc Dunnett's test using the \\textit{Mef/+} progeny as the controls.  An ANOVA analysis excluding the +/+ flies had a p-value of \\textbf{\\Sexpr{round(summary(restricted.flies.aov.males_mef)[[1]][[\"Pr(>F)\"]][1],3)}} for the UAS for males and a p-value of \\textbf{\\Sexpr{round(summary(restricted.flies.aov.females_mef)[[1]][[\"Pr(>F)\"]][1],3)}} for the UAS for the females.  The results of that test are in Tables \\ref{tab:total-flies-dunnett-gendered}.  This test indicates that each of the three Raptor shRNA knockdowns cause a reduction in the number of male flies, but only 34814 had significantly less females.\n\n<<label=total-fly-summary-gender-tables-mef,echo=FALSE,results=tex>>=\nprint(xtable(total_fly_summary_males_mef, caption=\"Summary of the Number of Male Flies by Driver and UAS\", label=\"tab:total-flies-summary-males-mef\"), include.rownames=F)\nprint(xtable(total_fly_summary_females_mef, caption=\"Summary of the Number of Female Flies by Driver and UAS\", label=\"tab:total-flies-summary-females-mef\"), include.rownames=F)\nprint(xtable(total.flies.aov.males_mef, caption=\"ANOVA for the Number of Male Flies by Driver and UAS\", label=\"tab:total-flies-anova-males-mef\"))\nprint(xtable(total.flies.aov.females_mef, caption=\"ANOVA for the Number of Female Flies by Driver and UAS\", label=\"tab:total-flies-anova-females-mef\"))\nprint(xtable(fly.dunnett.summary.gendered_mef, caption=\"Dunnett's Test for the Number of Males and Females Comparing to Control (Mef-Gal4/+)\", label=\"tab:total-flies-dunnett-gendered-mef\", digits=c(0,1,7,1,7)))\n@\n\n\\begin{figure}\n\\begin{center}\n<<label=total-fly-barplot-gendered-mef,fig=TRUE,echo=FALSE>>=\npar(mfrow=c(2,1))\nymax <- max(total_fly_summary_males_mef$mean+total_fly_summary_males_mef$se, na.rm=T)\nplot <- barplot(total_fly_summary_males_mef$mean,\n        beside=T, las=1,\n        ylim=c(0,ymax),\n        names.arg=total_fly_summary_males_mef$UAS,\n        col=total_fly_summary_males_mef$Gene,\n        ylab=\"Total Number of Flies\",\n        xlab=\"shRNA Clone\",\n        main=\"Total Number of Male Flies\")\n\nlegend(\"top\", levels(total_fly_summary_males_mef$Gene), fill= palette()[1:length(levels(total_fly_summary_males_mef$Gene))], bty='n')\n\nsuperpose.eb(plot, \n             total_fly_summary_males_mef$mean,\n             total_fly_summary_males_mef$se)\n\nymax <- max(total_fly_summary_females_mef$mean+total_fly_summary_females_mef$se, na.rm=T)\nplot <- barplot(total_fly_summary_females_mef$mean,\n        beside=T, las=1,\n        ylim=c(0,ymax),\n        names.arg=total_fly_summary_females_mef$UAS,\n        col=total_fly_summary_females_mef$Gene,\n        ylab=\"Total Number of Flies\",\n        xlab=\"shRNA Clone\",\n        main=\"Total Number of Female Flies\")\n\nsuperpose.eb(plot, \n             total_fly_summary_females_mef$mean,\n             total_fly_summary_females_mef$se)\n@\n\\end{center}\n\\caption{Total number of flies counted, separated by gender.  Presented as mean +/- standard error.}\n\\label{fig:total-flies-barplot-gendered-mef}\n\\end{figure}\n     \n     \n<<bibliography, include=F, echo=F>>=\nrequire(bibtex)\nwrite.bib(c(names(sessionInfo()$otherPkgs),'base','stats','utils'), file='birth-references.bib')\n@\n\nThe key packages used in this analysis were R \\cite{base}, plyr \\cite{plyr}, reshape2 \\cite{reshape2} and multcomp \\cite{multcomp}.\n\n\\bibliography{birth-references}\n\\bibliographystyle{unsrt}\n\n\\section*{Session Information}\n<<sessionInfo, results=tex, echo=F>>=\ntoLatex(sessionInfo())\n@\n\n\\end{document}",
    "created" : 1393254855566.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "855918976",
    "id" : "16878C7",
    "lastKnownWriteTime" : 1393254400,
    "path" : "/Volumes/bridges_lab/Hatfield/Drosophila/Births/birth-rates-second-crosses.Rnw",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "sweave"
}